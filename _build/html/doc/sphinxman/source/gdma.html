<!DOCTYPE html>

<html lang="English" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Interface to GDMA Distributed Multipole Analysis by A. J. Stone |w---w| gdma() &#8212; Psi4 Documentation 1.11 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../_static/documentation_options.js?v=29ef4520"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="interface-to-gdma-distributed-multipole-analysis-by-a-j-stone-w-w-gdma">
<span id="sec-gdma"></span><span id="index-0"></span><h1>Interface to GDMA Distributed Multipole Analysis by A. J. Stone <a href="#id3"><span class="problematic" id="id4">|w---w|</span></a> <code class="xref py py-func docutils literal notranslate"><span class="pre">gdma()</span></code><a class="headerlink" href="#interface-to-gdma-distributed-multipole-analysis-by-a-j-stone-w-w-gdma" title="Link to this heading">¶</a></h1>
<p><em>Module:</em> <span class="xref std std-ref">Keywords</span>, <span class="xref std std-ref">PSI Variables</span>, <a href="#id1"><span class="problematic" id="id2">:source:`GDMA_INTERFACE&lt;psi4/src/psi4/gdma_interface&gt;`</span></a></p>
<a class="reference external image-reference" href="https://github.com/psi4/gdma"><img alt="https://img.shields.io/badge/home-gdma-5077AB.svg" src="https://img.shields.io/badge/home-gdma-5077AB.svg" /></a>
<br><a class="reference external image-reference" href="http://www-stone.ch.cam.ac.uk/documentation/gdma/manual.pdf"><img alt="https://img.shields.io/badge/docs-latest-5077AB.svg" src="https://img.shields.io/badge/docs-latest-5077AB.svg" /></a>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<p><strong>Binary</strong></p>
<ul>
<li><a class="reference external image-reference" href="https://anaconda.org/psi4/gdma"><img alt="https://anaconda.org/psi4/gdma/badges/version.svg" src="https://anaconda.org/psi4/gdma/badges/version.svg" /></a>
</li>
<li><p>GDMA is available as a conda package for Linux and macOS (and Windows, through the Ubuntu shell).</p></li>
<li><p>If using the <a href="#id5"><span class="problematic" id="id6">|PSIfour|</span></a> binary, gdma has already been installed alongside.</p></li>
<li><p>If using <a href="#id7"><span class="problematic" id="id8">|PSIfour|</span></a> built from source, and anaconda or miniconda has
already been installed (instructions at <a class="reference internal" href="conda.html#sec-quickconda"><span class="std std-ref">Quick Installation</span></a>),
gdma can be obtained through <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">gdma</span> <span class="pre">-c</span> <span class="pre">psi4</span></code>.
Then enable it as a feature with <strong class="makevar">ENABLE_gdma</strong>,
hint its location with <strong class="makevar">CMAKE_PREFIX_PATH</strong>,
and rebuild <a href="#id9"><span class="problematic" id="id10">|PSIfour|</span></a> to detect gdma and activate dependent code.</p></li>
</ul>
<ul class="simple">
<li><p>To remove a conda installation, <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">remove</span> <span class="pre">gdma</span></code>.</p></li>
</ul>
<p><strong>Source</strong></p>
<ul>
<li><a class="reference external image-reference" href="https://github.com/psi4/gdma"><img alt="https://img.shields.io/github/tag/psi4/gdma.svg?maxAge=2592000" src="https://img.shields.io/github/tag/psi4/gdma.svg?maxAge=2592000" /></a>
</li>
<li><p>If using <a href="#id11"><span class="problematic" id="id12">|PSIfour|</span></a> built from source and you want gdma built from
from source also,
enable it as a feature with <strong class="makevar">ENABLE_gdma</strong>,
and let the build system fetch and build it and activate dependent code.</p></li>
</ul>
</section>
<section id="input">
<h2>Input<a class="headerlink" href="#input" title="Link to this heading">¶</a></h2>
<p>The distributed multipole analysis (DMA) technique, developed by Anthony J.
Stone and implemented by him into the <a class="reference external" href="http://www-stone.ch.cam.ac.uk/programs.html">GDMA package</a>, is available in <a href="#id13"><span class="problematic" id="id14">|PSIfour|</span></a>.
The current implementation simply embeds Stone's GDMA code into the main
executable, and generates the appropriate input files automatically.  The
program takes as input a data file, and a Gaussian formatted checkpoint (see
Section <a class="reference internal" href="fchk.html#sec-fchk"><span class="std std-ref">FCHK</span></a>) file.  The simplest usage of the GDMA code is
demonstrated below, along with a listing of the options supported; these
options correspond to the options described in the
<code class="xref download docutils literal notranslate"><span class="pre">GDMA</span> <span class="pre">manual</span></code>.</p>
<p>If more advanced usage is desired, which is not is permitted by the options
listed below, the user may provide their own data file containing keywords to
control the GDMA code.  Simply place the data file in the directory <a href="#id15"><span class="problematic" id="id16">|PSIfour|</span></a>
is called from, and provide the file name as the datafile argument to the
<code class="xref py py-func docutils literal notranslate"><span class="pre">gdma()</span></code> routine.  For example, if GDMA data file is called
<em>control.dma</em>, the GDMA code is called as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grad</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">gradient</span><span class="p">(</span><span class="s1">&#39;mp2&#39;</span><span class="p">,</span> <span class="n">return_wfn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gdma</span><span class="p">(</span><span class="n">wfn</span><span class="p">,</span> <span class="n">datafile</span><span class="o">=</span><span class="s1">&#39;control.dma&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>An FCHK file will be generated for the GDMA code to read; this file will have
the prefix given by <a href="#id17"><span class="problematic" id="id18">|globals__writer_file_label|</span></a> (if set), or else by the name
of the output file plus the name of the current molecule, and the suffix will
be '.fchk'.  This FCHK file name should be passed to the 'File' keyword in the
DGMA data file, to ensure that the GDMA code reads the correct wavefunction
information.</p>
<p>After running, two matrices of results can be accessed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dma_results</span> <span class="o">=</span> <span class="n">get_array_variable</span><span class="p">(</span><span class="s1">&#39;DMA DISTRIBUTED MULTIPOLES&#39;</span><span class="p">)</span>
<span class="n">tot_results</span> <span class="o">=</span> <span class="n">get_array_variable</span><span class="p">(</span><span class="s1">&#39;DMA TOTAL MULTIPOLES&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The first contains distributed multipoles, in units given by
<a href="#id19"><span class="problematic" id="id20">|gdma__gdma_multipole_units|</span></a>, with the row index corresponding to the site and
the column index referencing the multipole component.  Both indices are zero
based, and the <span class="math notranslate nohighlight">\(Q^l_m\)</span> components of the multipoles are ordered as
<span class="math notranslate nohighlight">\(Q^0_0, Q^1_0, Q^1_{1c}, Q^1_{1s}, Q^2_0, Q^2_{1c}, Q^2_{1s}, Q^2_{2c},
Q^2_{2s}, \ldots\)</span>  The second matrix returned has a single row, whose columns
are the total multipoles, translated to <a href="#id21"><span class="problematic" id="id22">|gdma__gdma_origin|</span></a>, and summed.</p>
</section>
<section id="options">
<h2>Options<a class="headerlink" href="#options" title="Link to this heading">¶</a></h2>
</section>
<section id="how-to-configure-gdma-for-building-psi4">
<span id="cmake-gdma"></span><h2>How to configure gdma for building Psi4<a class="headerlink" href="#how-to-configure-gdma-for-building-psi4" title="Link to this heading">¶</a></h2>
<p><strong>Role and Dependencies</strong></p>
<ul class="simple">
<li><p>Role <a href="#id23"><span class="problematic" id="id24">|w---w|</span></a> In <a href="#id25"><span class="problematic" id="id26">|PSIfour|</span></a>, GDMA is a library that provides additional
quantum chemical capabilities (multipole analysis).</p></li>
<li><p>Downstream Dependencies <a href="#id27"><span class="problematic" id="id28">|w---w|</span></a> <a href="#id29"><span class="problematic" id="id30">|PSIfour|</span></a> (<a href="#id31"><span class="problematic" id="id32">|dr|</span></a> optional) gdma</p></li>
<li><p>Upstream Dependencies <a href="#id33"><span class="problematic" id="id34">|w---w|</span></a> gdma <a href="#id35"><span class="problematic" id="id36">|dr|</span></a> Fortran</p></li>
</ul>
<p><strong>CMake Variables</strong></p>
<ul class="simple">
<li><p><strong class="makevar">ENABLE_gdma</strong> <a href="#id37"><span class="problematic" id="id38">|w---w|</span></a> CMake variable toggling whether Psi4 builds with gdma</p></li>
<li><p><strong class="makevar">CMAKE_PREFIX_PATH</strong> <a href="#id39"><span class="problematic" id="id40">|w---w|</span></a> CMake list variable to specify where pre-built dependencies can be found. For gdma, set to an installation directory containing <code class="docutils literal notranslate"><span class="pre">include/GDMA/GDMA_MANGLE.h</span></code></p></li>
<li><p><strong class="makevar">gdma_DIR</strong> <a href="#id41"><span class="problematic" id="id42">|w---w|</span></a> CMake variable to specify where pre-built gdma can be found. Set to installation directory containing <code class="docutils literal notranslate"><span class="pre">share/cmake/gdma/gdmaConfig.cmake</span></code></p></li>
<li><p><strong class="makevar">CMAKE_DISABLE_FIND_PACKAGE_gdma</strong> <a href="#id43"><span class="problematic" id="id44">|w---w|</span></a> CMake variable to force internal build of gdma instead of detecting pre-built</p></li>
<li><p><strong class="makevar">CMAKE_INSIST_FIND_PACKAGE_gdma</strong> <a href="#id45"><span class="problematic" id="id46">|w---w|</span></a> CMake variable to force detecting pre-built gdma and not falling back on internal build</p></li>
</ul>
<p><strong>Examples</strong></p>
<ol class="upperalpha simple">
<li><p>Build bundled</p></li>
</ol>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt;<span class="w"> </span>cmake<span class="w"> </span>-DENABLE_gdma<span class="o">=</span>ON
</pre></div>
</div>
</div></blockquote>
<ol class="upperalpha simple" start="2">
<li><p>Build <em>without</em> gdma</p></li>
</ol>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt;<span class="w"> </span>cmake
</pre></div>
</div>
</div></blockquote>
<ol class="upperalpha simple" start="3">
<li><p>Link against pre-built</p></li>
</ol>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt;<span class="w"> </span>cmake<span class="w"> </span>-DENABLE_gdma<span class="o">=</span>ON<span class="w"> </span>-DCMAKE_PREFIX_PATH<span class="o">=</span>/path/to/gdma/root
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt;<span class="w"> </span>cmake<span class="w"> </span>-DENABLE_gdma<span class="o">=</span>ON<span class="w"> </span>-Dgdma_DIR<span class="o">=</span>/path/to/gdma/configdir
</pre></div>
</div>
</div></blockquote>
<ol class="upperalpha simple" start="4">
<li><p>Build bundled despite pre-built being detectable</p></li>
</ol>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt;<span class="w"> </span>cmake<span class="w"> </span>-DENABLE_gdma<span class="o">=</span>ON<span class="w"> </span>-DCMAKE_PREFIX_PATH<span class="o">=</span>/path/to/unwanted/gdma/root/and/wanted/other/dependencies/root<span class="w"> </span>-DCMAKE_DISABLE_FIND_PACKAGE_gdma<span class="o">=</span>ON
</pre></div>
</div>
</div></blockquote>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Psi4 Documentation</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Harishankar.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../_sources/doc/sphinxman/source/gdma.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>