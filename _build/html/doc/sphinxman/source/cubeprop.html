<!DOCTYPE html>

<html lang="English" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Generation of Cube Files |w---w| cubeprop() &#8212; Psi4 Documentation 1.11 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../_static/documentation_options.js?v=29ef4520"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="generation-of-cube-files-w-w-cubeprop">
<span id="sec-cubeprop"></span><span id="index-0"></span><h1>Generation of Cube Files <a href="#id5"><span class="problematic" id="id6">|w---w|</span></a> <code class="xref py py-func docutils literal notranslate"><span class="pre">cubeprop()</span></code><a class="headerlink" href="#generation-of-cube-files-w-w-cubeprop" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p><a href="#id7"><span class="problematic" id="id8">|PSIfour|</span></a> has the ability to export cube files that store information about
basis functions, molecular orbitals, the electron density, and
the electrostatic potential (ESP).  Cube files store the value of a scalar
quantity on a regular Cartesian grid, and can be visualized with several
visualization programs, some of which are free, like VMD
(<a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd/">http://www.ks.uiuc.edu/Research/vmd/</a>).</p>
<p>An example utilization of the code is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">molecule</span> <span class="n">h2o</span> <span class="p">{</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="n">O</span>
<span class="n">H</span> <span class="mi">1</span> <span class="mf">1.0</span>
<span class="n">H</span> <span class="mi">1</span> <span class="mf">1.0</span> <span class="mi">2</span> <span class="mf">104.5</span>
<span class="p">}</span>

<span class="nb">set</span> <span class="n">basis</span> <span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span>
<span class="nb">set</span> <span class="n">scf_type</span> <span class="n">df</span>
<span class="nb">set</span> <span class="n">freeze_core</span> <span class="kc">True</span>
<span class="nb">set</span> <span class="n">cubeprop_tasks</span> <span class="p">[</span><span class="s1">&#39;orbitals&#39;</span><span class="p">]</span>
<span class="nb">set</span> <span class="n">cubeprop_orbitals</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">]</span>

<span class="n">E</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">energy</span><span class="p">(</span><span class="s1">&#39;scf&#39;</span><span class="p">,</span> <span class="n">return_wfn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cubeprop</span><span class="p">(</span><span class="n">wfn</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, the <code class="xref py py-func docutils literal notranslate"><span class="pre">cubeprop()</span></code>
call after the <code class="docutils literal notranslate"><span class="pre">energy('scf')</span></code> command
executes the cubeprop code.  The array <a href="#id9"><span class="problematic" id="id10">|globals__cubeprop_tasks|</span></a> specifies which
tasks should be executed.  In this case the task <code class="docutils literal notranslate"><span class="pre">'orbitals'</span></code> generates cube
files for orbitals.  The <a href="#id11"><span class="problematic" id="id12">|globals__cubeprop_orbitals|</span></a> option specifies that cube files
should be generated only for alpha orbitals 5 (HOMO) and 6 (LUMO) and
beta orbitals 5 (indicated as -5) and 6.
If the option <a href="#id13"><span class="problematic" id="id14">|globals__cubeprop_orbitals|</span></a> is not provided, then cube files are
generated for all orbitals.
After running, the above input will generate four files: <code class="docutils literal notranslate"><span class="pre">Psi_a_5_1-B1.cube</span></code>,
<code class="docutils literal notranslate"><span class="pre">Psi_a_6_4-A1.cube</span></code>, <code class="docutils literal notranslate"><span class="pre">Psi_a_5_1-B1.cube</span></code>, and <code class="docutils literal notranslate"><span class="pre">Psi_a_6_4-A1.cube</span></code>. The subscript <code class="docutils literal notranslate"><span class="pre">a</span></code> in
<code class="docutils literal notranslate"><span class="pre">Psi_a_5_1-B1.cube</span></code> indicates an alpha orbital. The first number (<code class="docutils literal notranslate"><span class="pre">5</span></code>) is the index of the
orbital while <code class="docutils literal notranslate"><span class="pre">1-B1</span></code> indicates that this is the first orbital that belongs to the B1 irrep.
The file <code class="docutils literal notranslate"><span class="pre">Psi_a_5_1-B1.cube</span></code> begins with two comment lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Psi4</span> <span class="n">Gaussian</span> <span class="n">Cube</span> <span class="n">File</span><span class="o">.</span>
<span class="n">Property</span><span class="p">:</span> <span class="n">Psi_a_5_1</span><span class="o">-</span><span class="n">B1</span><span class="o">.</span> <span class="n">Isocontour</span> <span class="nb">range</span> <span class="k">for</span> <span class="mi">85</span><span class="o">%</span> <span class="n">of</span> <span class="n">the</span> <span class="n">density</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0787495</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0787495</span><span class="p">)</span>
</pre></div>
</div>
<p>The second line reports the isocontour values that capture 85% of the probability density using
the least amount of grid points. This quantity is determined for orbitals and densities. The
fraction of the density captured by the isocontour values is by default 0.85, but can
be changed via the option <a href="#id15"><span class="problematic" id="id16">|globals__cubeprop_isocontour_threshold|</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your cube plots are too coarse, try to decrease the grid spacing via
the option <a href="#id17"><span class="problematic" id="id18">|globals__cubic_grid_spacing|</span></a>.  If the edges of your plot are cut then
increase the size of the grid via the option <a href="#id19"><span class="problematic" id="id20">|globals__cubic_grid_overage|</span></a>.</p>
</div>
</section>
<section id="cubeprop-tasks">
<h2>Cubeprop Tasks<a class="headerlink" href="#cubeprop-tasks" title="Link to this heading">¶</a></h2>
<p>The cubeprop utility can be provided a list of tasks to perform.
Tasks are specified by the <a href="#id21"><span class="problematic" id="id22">|globals__cubeprop_tasks|</span></a> option, which is a list of strings
that identify the tasks.  Several tasks are available. These include:</p>
<dl class="simple">
<dt>ORBITALS [Default if  <a href="#id23"><span class="problematic" id="id24">|globals__cubeprop_tasks|</span></a> is not specified]</dt><dd><p>Produces cube representations of the molecular orbitals
<span class="math notranslate nohighlight">\(\psi_q(\mathbf{r})\)</span>.  Orbitals are sorted according to increasing
orbital energy ignoring symmetry.</p>
</dd>
<dt>FRONTIER_ORBITALS</dt><dd><p>Produces cube representations of the frontier molecular orbitals. For closed shell
species, the highest occupied (HOMO) and the lowest unoccupied (LUMO) alpha orbitals (ie.
<span class="math notranslate nohighlight">\(\psi_{\alpha}(\mathbf{r})\)</span>) are printed, while for open shell species a total
of <span class="math notranslate nohighlight">\((4 + M_s)\)</span> orbitals are printed (<span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>
spin for both lowest virtual (LVMO) and highest doubly occupied
orbitals (DOMO), along with all <span class="math notranslate nohighlight">\(\alpha\)</span> singly occupied (SOMO) orbitals).</p>
</dd>
<dt>DENSITY</dt><dd><p>This task can be used to obtain the alpha and beta electron densities,
<span class="math notranslate nohighlight">\(\rho_\alpha(\mathbf{r})\)</span> and <span class="math notranslate nohighlight">\(\rho_\beta(\mathbf{r})\)</span>, together
with the total density
<span class="math notranslate nohighlight">\(\rho(\mathbf{r}) = \rho_\alpha(\mathbf{r}) + \rho_\beta(\mathbf{r})\)</span>,
and the spin density
<span class="math notranslate nohighlight">\(\rho(\mathbf{r}) = \rho_\alpha(\mathbf{r}) - \rho_\beta(\mathbf{r})\)</span>.</p>
</dd>
<dt>BASIS_FUNCTIONS</dt><dd><p>This task is useful to produce cube files of the atomic orbital basis
functions <span class="math notranslate nohighlight">\(\chi_\mu(\mathbf{r})\)</span>.</p>
</dd>
<dt>ESP</dt><dd><p>Calculates the total (nuclear + electronic) electrostatic potential
<span class="math notranslate nohighlight">\(V(\mathbf{r})\)</span>.</p>
</dd>
<dt>DUAL_DESCRIPTOR</dt><dd><p>Calculates the dual descriptor from frontier orbitals:
<span class="math notranslate nohighlight">\(f^2(\mathbf{r})=\rho_{\mathrm{LUMO}}(\mathbf{r})-\rho_{\mathrm{HOMO}}(\mathbf{r})\)</span>.
The dual descriptor is a good measure of nucleophilicity and electrophilicity,
containing information essentially equivalent to both Fukui functions combined.
More details on the dual descriptor itself can be found in <a class="reference internal" href="bibliography.html#morell-2005-205" id="id1"><span>[Morell:2005:205]</span></a>,
while the current implementation is described in <a class="reference internal" href="bibliography.html#martinez-araya-2015-451" id="id2"><span>[Martinez-Araya:2015:451]</span></a>.
This feature is currently only supported for closed shell systems.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ESP</span></code> task requires the user to specify a density-fitting basis
via the <a href="#id25"><span class="problematic" id="id26">|scf__df_basis_scf|</span></a> keyword.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is important to specify the <a href="#id27"><span class="problematic" id="id28">|globals__cubeprop_orbitals|</span></a> option when
dealing with large molecules to avoid running out of disk space.
For example, using the default grid spacing of
0.2 <a href="#id29"><span class="problematic" id="id30">|Angstrom|</span></a>, the size of a single cube file for a molecule like water
is of the order of 1.4 MB.  For a molecule with 200 basis functions, the cube
files for all the orbitals occupy more than half a GB.</p>
</div>
</section>
<section id="keywords">
<h2>Keywords<a class="headerlink" href="#keywords" title="Link to this heading">¶</a></h2>
</section>
</section>
<section id="orbital-visualization-with-vmd">
<h1>Orbital Visualization with VMD<a class="headerlink" href="#orbital-visualization-with-vmd" title="Link to this heading">¶</a></h1>
<p>Included in <a href="#id31"><span class="problematic" id="id32">|PSIfour|</span></a> is functionality to automatically render specified surfaces, including molecular orbitals,
densities, and basis functions, using VMD. The vmd_cube.py script takes the .cube files generated
in a calculation and generates images aligned with user-input specifications. The script is located
in <a href="#id3"><span class="problematic" id="id4">:source:`psi4/share/psi4/scripts/vmd_cube.py`</span></a>.</p>
<section id="script-prerequisites">
<h2>Script Prerequisites<a class="headerlink" href="#script-prerequisites" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>VMD must be installed, and it can be downloaded for free at (<a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd/">http://www.ks.uiuc.edu/Research/vmd/</a>). Additionally,
the script needs to know where to find the VMD executable, and this is defined as <span class="target" id="index-1"></span><a class="reference internal" href="#envvar-VMDPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">VMDPATH</span></code></a>. VMDPATH must be defined as
an environment variable.</p></li>
<li><p>To generate images with multiple surfaces, ImageMagick must also be installed. ImageMagick is a free program which
can be installed using homebrew/pip or from <a class="reference external" href="http://www.imagemagick.org/script/binary-releases.php">http://www.imagemagick.org/script/binary-releases.php</a> .</p></li>
<li><p>With ImageMagick installed, an environment variable called <span class="target" id="index-2"></span><a class="reference internal" href="#envvar-MONTAGE"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MONTAGE</span></code></a> needs to be created which points to the montage executable.
This executable can be found in the /bin/ sub-directory wherever ImageMagick was installed.</p></li>
</ol>
<dl class="std envvar">
<dt class="sig sig-object std" id="envvar-VMDPATH">
<span class="sig-name descname"><span class="pre">VMDPATH</span></span><a class="headerlink" href="#envvar-VMDPATH" title="Link to this definition">¶</a></dt>
<dd><p>Filesystem path to the VMD executable.</p>
</dd></dl>

<dl class="std envvar">
<dt class="sig sig-object std" id="envvar-MONTAGE">
<span class="sig-name descname"><span class="pre">MONTAGE</span></span><a class="headerlink" href="#envvar-MONTAGE" title="Link to this definition">¶</a></dt>
<dd><p>Filesystem path to the Montage executable of ImageMagick</p>
</dd></dl>

</section>
<section id="running-the-script">
<h2>Running the Script<a class="headerlink" href="#running-the-script" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Run a <a href="#id33"><span class="problematic" id="id34">|PSIfour|</span></a> calculation, generating .cube files as detailed in the above documentation.</p></li>
<li><p>Add vmd_cube.py to your path. Call vmd_cube.py and pass the directory containing
the .cube files as an argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">vmd_cube</span><span class="o">.</span><span class="n">py</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">cube</span><span class="o">/</span><span class="n">files</span><span class="o">/</span>
</pre></div>
</div>
<p>By default the script will search for cube files in the directory in which it is called.
In addition to individual image files for each orbital, vmd_cube will also generate an image containing all surfaces in an array
(very useful for hand-picking orbital spaces)</p>
</li>
<li><p>As an example, take the cube files generated from the water calculation from the above input file.
Using vmd_cube the alpha molecular orbitals can be rendered and output in one image with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">vmd_cube</span><span class="o">.</span><span class="n">py</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">cube</span><span class="o">/</span><span class="n">files</span><span class="o">/</span> <span class="o">--</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span> <span class="o">--</span><span class="n">rx</span><span class="o">=</span><span class="mi">90</span> <span class="o">--</span><span class="n">ry</span><span class="o">=</span><span class="mi">60</span>
</pre></div>
</div>
</li>
</ol>
<p>The desired image in this case is called &quot;AlphaMOs.tga&quot;, and looks like this:</p>
<a class="reference internal image-reference" href="AlphaMOs.png"><img alt="Alpha MOs" class="align-center" src="AlphaMOs.png" /></a>
</section>
<section id="script-options">
<h2>Script Options<a class="headerlink" href="#script-options" title="Link to this heading">¶</a></h2>
<p>The help for <code class="docutils literal notranslate"><span class="pre">vmd_cube.py</span></code> can be obtained from the console:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="o">./</span><span class="n">vmd_cube</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">help</span>
<span class="go">usage: vmd_cube.py [-h] [--color1 [&lt;integer&gt;]] [--color2 [&lt;integer&gt;]]</span>
<span class="go">                   [--iso [&lt;isovalue&gt;]] [--rx [&lt;angle&gt;]] [--ry [&lt;angle&gt;]]</span>
<span class="go">                   [--rz [&lt;angle&gt;]] [--tx [&lt;length&gt;]] [--ty [&lt;length&gt;]]</span>
<span class="go">                   [--tz [&lt;length&gt;]] [--opacity [&lt;opacity&gt;]]</span>
<span class="go">                   [--scale [&lt;factor&gt;]] [--no-montage] [--no-labels]</span>
<span class="go">                   [--imagesize [&lt;integer&gt;]] [--imagew [&lt;integer&gt;]]</span>
<span class="go">                   [--imageh [&lt;integer&gt;]] [--fontsize [&lt;integer&gt;]]</span>
<span class="go">                   [--interactive] [--gzip] [--national_scheme]</span>
<span class="go">                   [--silver_scheme] [--bright_scheme] [--electron_scheme]</span>
<span class="go">                   [&lt;cubefile dir&gt;]</span>

<span class="go">vmd_cube is a script to render cube files with vmd. To generate cube files</span>
<span class="go">with Psi4 add the command cubeprop() at the end of your input file.</span>

<span class="go">positional arguments:</span>
<span class="go">  &lt;cubefile dir&gt;        The directory containing the cube files.</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  --color1 [&lt;integer&gt;]  the color ID of surface 1 (integer, default = 3)</span>
<span class="go">  --color2 [&lt;integer&gt;]  the color ID of surface 2 (integer, default = 23)</span>
<span class="go">  --iso [&lt;isovalue&gt;]    the isosurface value (float, default = 0.05)</span>
<span class="go">  --rx [&lt;angle&gt;]        the x-axis rotation angle (float, default = 30.0)</span>
<span class="go">  --ry [&lt;angle&gt;]        the y-axis rotation angle (float, default = 40.0)</span>
<span class="go">  --rz [&lt;angle&gt;]        the z-axis rotation angle (float, default = 15.0)</span>
<span class="go">  --tx [&lt;length&gt;]       the x-axis translation (float, default = 0.0)</span>
<span class="go">  --ty [&lt;length&gt;]       the y-axis translation (float, default = 0.0)</span>
<span class="go">  --tz [&lt;length&gt;]       the z-axis translation (float, default = 0.0)</span>
<span class="go">  --opacity [&lt;opacity&gt;]</span>
<span class="go">                        opacity of the isosurface (float, default = 1.0)</span>
<span class="go">  --scale [&lt;factor&gt;]    the scaling factor (float, default = 1.0)</span>
<span class="go">  --no-montage          call montage to combine images. (string, default =</span>
<span class="go">                        false)</span>
<span class="go">  --no-labels           do not add labels to images. (string, default = false)</span>
<span class="go">  --imagesize [&lt;integer&gt;]</span>
<span class="go">                        the size of each image (integer, default = 250)</span>
<span class="go">  --imagew [&lt;integer&gt;]  the width of images (integer, default = 250)</span>
<span class="go">  --imageh [&lt;integer&gt;]  the height of images (integer, default = 250)</span>
<span class="go">  --fontsize [&lt;integer&gt;]</span>
<span class="go">                        the font size (integer, default = 20)</span>
<span class="go">  --interactive         run in interactive mode (default = false)</span>
<span class="go">  --gzip                gzip cube files (default = false)</span>
<span class="go">  --national_scheme     use a red/blue color scheme. (string, default = false)</span>
<span class="go">  --silver_scheme       use a gray/white color scheme. (string, default =</span>
<span class="go">                        false)</span>
<span class="go">  --bright_scheme       use a soft yellow/blue color scheme. (string, default</span>
<span class="go">                        = false)</span>
<span class="go">  --electron_scheme     use a purple/green color scheme. (string, default =</span>
<span class="go">                        false)</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Psi4 Documentation</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Harishankar.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../_sources/doc/sphinxman/source/cubeprop.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>