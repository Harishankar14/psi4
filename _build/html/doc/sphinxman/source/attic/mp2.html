<!DOCTYPE html>

<html lang="English" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Second-order |MollerPlesset| Theory: MP2 and MP2-R12 methods &#8212; Psi4 Documentation 1.11 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../../_static/documentation_options.js?v=29ef4520"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="second-order-mollerplesset-theory-mp2-and-mp2-r12-methods">
<span id="sec-mp2"></span><h1>Second-order <a href="#id2"><span class="problematic" id="id3">|MollerPlesset|</span></a> Theory: MP2 and MP2-R12 methods<a class="headerlink" href="#second-order-mollerplesset-theory-mp2-and-mp2-r12-methods" title="Link to this heading">¶</a></h1>
<p>Second-order <a href="#id4"><span class="problematic" id="id5">|MollerPlesset|</span></a> theory is one of the most basic
wavefunction approaches which includes electron correlation
directly.
Due to its simplicity, the MP2 method is often the best
level one can afford for a larger molecular system.
At the other end of the spectrum, the MP2-R12 method
of Kutzelnigg, Klopper, and co-workers is a promising
approach to computing MP2 energies in the complete
basis set limit for smaller systems. <a href="#id6"><span class="problematic" id="id7">|PSIfour|</span></a> is
one of the very few publicly available programs to
feature a robust implementation of the MP2-R12 method.</p>
<p><a href="#id8"><span class="problematic" id="id9">|PSIfour|</span></a> is capable of computing closed-shell
MP2 and MP2-R12/A energies using integral-direct techniques and a
multithreaded algorithm, which lends itself perfectly for execution
on symmetric multiprocessor (SMP) machines. <a href="#id10"><span class="problematic" id="id11">|PSIfour|</span></a> is also
capable of computing RHF, UHF, and ROHF (using semicanonical orbitals)
MP2 energies and one-particle density matrices, and RHF MP2 analytic
gradients.  Occupied and virtual orbitals can be frozen during the
energy calculation, but not for the calculation of the
one-particle density matrix or the analytic gradient.</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Summary of MP2 and MP2-R12 capabilities in <a href="#id12"><span class="problematic" id="id13">|PSIfour|</span></a></span><a class="headerlink" href="#id1" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Reference</p></th>
<th class="head"><p>Method</p></th>
<th class="head"><p>Energy (conv)</p></th>
<th class="head"><p>Energy (integral-direct)</p></th>
<th class="head"><p>Gradient</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>RHF</p></td>
<td><p>MP2</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
<td><p>Y</p></td>
</tr>
<tr class="row-odd"><td><p>UHF</p></td>
<td><p>MP2</p></td>
<td><p>Y</p></td>
<td><p>---</p></td>
<td><p>---</p></td>
</tr>
<tr class="row-even"><td><p>ROHF</p></td>
<td><p>MP2</p></td>
<td><p>Y</p></td>
<td><p>---</p></td>
<td><p>---</p></td>
</tr>
<tr class="row-odd"><td><p>RHF</p></td>
<td><p>MP2-R12/A</p></td>
<td><p>---</p></td>
<td><p>Y</p></td>
<td><p>---</p></td>
</tr>
</tbody>
</table>
<section id="basic-keywords">
<h2>Basic Keywords<a class="headerlink" href="#basic-keywords" title="Link to this heading">¶</a></h2>
<p>To compute a ground-state MP2 or MP2-R12 energy at a fixed geometry,
the following keywords are common:</p>
<p>item[WFN = string]mbox{}\
Acceptable values are {tt mp2} for MP2, {tt mp2r12} [for MP2-R12/A]
There is no default.</p>
<p>item[REFERENCE = string]mbox{}\
The only acceptable value are {tt rhf, uhf, and rohf}.
There is no default.</p>
<p>item[JOBTYPE = string]mbox{}\
Acceptable values are {tt sp} and {tt opt}.  There is no default.</p>
<p>item[MEMORY = (real MB)]mbox{}\
Specified the amount of core memory to be used, in MB.  Defaults to 256.
Other units (<em>e.g.</em>, KB or GB) are also allowed.</p>
<p>item[DIRECT = boolean]mbox{}\
Specifies whether to use the conventional ({tt false}) or
integral-direct ({tt true}) algorithm. Default is {tt false}.</p>
<p>item[NUM_THREADS = integer]mbox{}\
Specified the number of threads to be used in the integral-direct
computation (only valid if {tt DIRECT} is set to {tt true}).
Default is 1.</p>
<p>item[FREEZE_CORE = boolean]mbox{}\
Specifies whether core orbitals (which are determined automatically) are to
be excluded from the correlated calculations.  Default is {tt false}.</p>
<p>item[PRINT = integer]mbox{}\
The desired print level for detailed output.  Setting this to 2 is a good
idea for larger calculations so that the progress of the calculation may be
easily followed.  Defaults to 0.</p>
<p>item[OPDM = boolean]mbox{}\
If {tt true}, calculate the one-particle density matrix.  The default is false.</p>
<p>item[OPDM_WRITE = boolean]mbox{}\
If {tt true}, write the one-particle density matrix to disk.</p>
<p>item[OPDM_PRINT = boolean]mbox{}\
If {tt true}, print the one-particle density matrix to the output file.</p>
</section>
<section id="using-the-mp2-r12-method">
<h2>Using the MP2-R12 method<a class="headerlink" href="#using-the-mp2-r12-method" title="Link to this heading">¶</a></h2>
<p>Although this manual is not a how-to on running
quantum chemistry applications, the MP2-R12 method is
a rather non-standard tool, hence a few comments on its
use are appropriate.</p>
<ul class="simple">
<li><p>The version of the MP2-R12 method implemented in <a href="#id14"><span class="problematic" id="id15">|PSIfour|</span></a>
is a so-called single-basis MP2-R12 method
in standard approximation A. This means that a basis set
rather complete in Hartree--Fock (or one-particle) sense
is absolutely mandatory for meaningful computations with the MP2-R12
method. The user is strongly urged to read literature on
linear R12 methods before using <a href="#id16"><span class="problematic" id="id17">|PSIfour|</span></a> to compute MP2-R12
energies.</p></li>
<li><p>More robust, two-basis versions
of the MP2-R12 method, also known as the auxiliary basis
MP2-R12 method, have been implemented
in a publicly available Massively Parallel Quantum Chemistry (MPQC)
package (see url{<a class="reference external" href="http://aros.ca.sandia.gov/~cljanss/mpqc/">http://aros.ca.sandia.gov/~cljanss/mpqc/</a>}).
The two-basis version of the MP2-R12 method is a theoretically more
sound approach, and thus should be preferred to the single-basis method.
In some situations, however, it may make sense to use
the single-basis method.</p></li>
</ul>
</section>
<section id="larger-calculations">
<h2>Larger Calculations<a class="headerlink" href="#larger-calculations" title="Link to this heading">¶</a></h2>
<p>Here are a few recommendations for carrying out extended integral-direct MP2 and
MP2-R12 calculations with <a href="#id18"><span class="problematic" id="id19">|PSIfour|</span></a>:</p>
<ul class="simple">
<li><p>While the integral-direct MP2 algorithm doesn't need any
significant disk storage,
the integral-direct algorithm for the MP2-R12 energy
stores the transformed integrals to disk, hence very large
computations will require a lot of disk space. In general
the storage requirement is <span class="math notranslate nohighlight">\(16 o^2N^2\)</span> bytes, where <span class="math notranslate nohighlight">\(o\)</span>
is the number of occupied orbitals, and <span class="math notranslate nohighlight">\(N\)</span> is the size of the basis.</p></li>
<li><p>If there is not enough memory to perform the computation in one pass,
the program will do multiple passes through the entire set of integrals,
hence your computation will run that many times longer.
In such case, find the machine with the most memory and processors available.</p></li>
<li><p>On SMP machines, set the {tt NUM_THREADS} to the number of
processors available for the job, or, if all processors are allocated for
your job, set {tt NUM_THREADS} to {em twice} the number of processors
you have. Modern operating systems schedulers are usually very efficient
at handling multithreaded programs, so the overhead of thread context
switching is not significant, but using more threads may lead to better
load balancing, and lower execution times. For example, on a 32-processor
IBM eServer p690 we found that the optimal number of threads was 128.
For the optimal performance, do a few runs with different number of threads
and see which number works best.
Avoid excessively large
number of threads, as this descreases the net amount of memory available to
the computation and thus may increase the number of passes.</p></li>
<li><p>Set the {tt MEMORY} keyword to the 90% of the available physical
memory, at most. There is a small amount of overhead associated with the
integral-direct algorithms that is not accounted for by the internal memory
handling routines.</p></li>
<li><p>The implementation of the integral-direct MP2-R12 (and MP2) method
in <a href="#id20"><span class="problematic" id="id21">|PSIfour|</span></a> can run efficiently on SMP, or shared-memory, machines,
by utilizing multiple processors via multithreaded approach.
However, it cannot utilize distributed memory machines,
such as commodity (PC) clusters and massively parallel machines,
to their full potential, since one computation can only take advantage
of one node of such machine at a time.
In such environments, the aformentioned MPQC implementation of
the MP2-R12 method should be preferred
(see url{<a class="reference external" href="http://aros.ca.sandia.gov/~cljanss/mpqc/">http://aros.ca.sandia.gov/~cljanss/mpqc/</a>}).</p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">Psi4 Documentation</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Harishankar.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../../_sources/doc/sphinxman/source/attic/mp2.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>