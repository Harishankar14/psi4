<!DOCTYPE html>

<html lang="English" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Complete-Active-Space Self-Consistent-Field (CASSCF) &#8212; Psi4 Documentation 1.11 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../../_static/documentation_options.js?v=29ef4520"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="complete-active-space-self-consistent-field-casscf">
<span id="sec-casscf"></span><h1>Complete-Active-Space Self-Consistent-Field (CASSCF)<a class="headerlink" href="#complete-active-space-self-consistent-field-casscf" title="Link to this heading">¶</a></h1>
<p>Multi-configurational self-consistent-field (MCSCF)
is a general method for obtaining qualitatively correct
wavefunctions for highly strained molecules, diradicals, or bond
breaking reactions.  The most commonly used MCSCF procedure
is the complete-active-space self-consistent-field (CASSCF)
approach <a class="reference internal" href="../bibliography.html#roos-1980" id="id1"><span>[Roos:1980]</span></a>, which includes all possible determinants
(with the proper symmetry) that can be formed by distributing
a set of active electrons among a set of active orbitals.
The detcasman module performs
CASSCF optimization of molecular orbitals via a two-step
procedure in which the CI wavefunction is computed using
detci, and the orbital rotation step is computed using
detcas.  The detcas program is fairly simple
and uses an approximate orbital Hessian <a class="reference internal" href="../bibliography.html#chaban-1997-88" id="id2"><span>[Chaban:1997:88]</span></a>
and a Newton-Raphson update,
accelerated by Pulay's DIIS procedure <a class="reference internal" href="../bibliography.html#pulay-1980" id="id3"><span>[Pulay:1980]</span></a>.
We have also implemented a prototype version of the RASSCF method
<a class="reference internal" href="../bibliography.html#malmqvist-1990-rasscf" id="id4"><span>[Malmqvist:1990:RASSCF]</span></a>, which is another kind of MCSCF which
is typically less complete (and less expensive) than CASSCF.
However, orbital convergence for RASSCF can be difficult in our
current implementation.</p>
<p>Inactive orbitals in the MCSCF may be specified by the
<a href="#id11"><span class="problematic" id="id12">|detci__restricted_docc|</span></a> and <a href="#id13"><span class="problematic" id="id14">|detci__restricted_uocc|</span></a> keywords. These
orbitals will remain doubly-occupied or doubly-unoccupied, respectively,
in the MCSCF wavefunction.  However, the form of these orbitals will
be optimized in the MCSCF procedure.  It is also possible to
literally freeze inactive orbitals in their original (SCF) form
using the <a href="#id15"><span class="problematic" id="id16">|globals__frozen_docc|</span></a> and <a href="#id17"><span class="problematic" id="id18">|globals__frozen_uocc|</span></a> keywords.
This is not normally what one wishes to do in an MCSCF computation
(<em>e.g.</em>, it complicates the computation of gradients),
but it can make the computations faster and is helpful in some
circumstances where unphysical mixing of inactive and active
occupied orbitals might occur.  Presently, it is not possible
to mix the use of restricted and frozen orbitals in <a href="#id19"><span class="problematic" id="id20">|PSIfour|</span></a>.</p>
<p>The division of the molecular orbitals into various subspaces such as RAS
spaces, or frozen vs active orbitals, etc, needs to be clear not only to
the detci program, but also at least to the transformation program
(and in the case of MCSCF, to other programs as well).  Thus,
orbital subspace keywords such as <a href="#id21"><span class="problematic" id="id22">|detci__ras1|</span></a>, <a href="#id23"><span class="problematic" id="id24">|detci__ras2|</span></a>, <a href="#id25"><span class="problematic" id="id26">|detci__ras3|</span></a>, <a href="#id27"><span class="problematic" id="id28">|detci__ras4|</span></a>,
<a href="#id29"><span class="problematic" id="id30">|globals__frozen_docc|</span></a>, <a href="#id31"><span class="problematic" id="id32">|globals__frozen_uocc|</span></a>, <a href="#id33"><span class="problematic" id="id34">|detci__active|</span></a>, <em>etc.</em>, need to be
in the global <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">{...}</span></code> block section of the input file so they may
be accessed by other modules.</p>
<p>The ability to perform state-averaged
<span id="id5">[Docken:1972:4928]</span> <span id="id6">[Ruedenberg:1979:1069]</span>
CASSCF or RASSCF computations has been added.  This is accomplished using the
<a href="#id35"><span class="problematic" id="id36">|detci__avg_states|</span></a> keyword.</p>
<p>See the <a href="#id7"><span class="problematic" id="id8">:srcsample:`casscf-sp`</span></a> and <a href="#id9"><span class="problematic" id="id10">:srcsample:`casscf-sa-sp`</span></a> examples in the
samples directory and the example below.</p>
<section id="basic-keywords">
<h2>Basic Keywords<a class="headerlink" href="#basic-keywords" title="Link to this heading">¶</a></h2>
<p>WFN = string
This may be <code class="docutils literal notranslate"><span class="pre">casscf</span></code> or <code class="docutils literal notranslate"><span class="pre">rasscf</span></code>.</p>
<p>REFERENCE = string
Any of the references allowed by detci should work (<em>i.e.</em>, not
{tt uhf}), but there should be no reason not to use {tt rhf}.</p>
<p>DERTYPE = string
At present, only energies ({tt none}) are supported; future
releases will implement gradients ({tt first}).</p>
<p>CONVERGENCE = integer
Convergence desired on the orbital gradient.  Convergence is achieved when
the RMS of the error in the orbital gradient is less than 10**(-n).  The
default is 4 for energy calculations and 7 for gradients.  Note that
this is a different convergence criterion than for the PSIdetciprogram itself.  These can be differentiated, if changed by the user,
by placing the {tt CONVERGENCE} keywords within separate sections of
input, such as {tt detcas: ( convergence = x )}.</p>
<p>ENERGY_CONVERGENCE = integer
Convergence desired on the total MCSCF energy.  The default is 7.
item[RESTRICTED_DOCC = (integer array)]mbox{}\
Should be in {tt psi:()} or {tt default:()} sections of input.
The number of lowest energy doubly occupied orbitals in each irreducible
representation from which there will be no excitations.
These orbitals are optimized in the MCSCF.
The Cotton ordering of the irredicible representations is used.
The default is the zero vector.</p>
<p>RESTRICTED_UOCC = (integer array)
Should be in {tt psi:()} or {tt default:()} sections of input.
The number of highest energy unoccupied orbitals in each irreducible
representation into which there will be no excitations.
These orbitals are optimized in the MCSCF.
The default is the zero vector.</p>
<p>FROZEN_DOCC = (integer array)]mbox{}\
Should be in {tt psi:()} or {tt default:()} sections of input.
The number of lowest energy doubly occupied orbitals in each irreducible
representation from which there will be no excitations.
These orbitals are literally frozen and are not optimized in the MCSCF;
usually one wishes to use {tt RESTRICTED_DOCC} instead.
The current version of the program does not allow both
{tt RESTRICTED_DOCC} and {tt FROZEN_DOCC}.
Should be in {tt psi:()} or {tt default:()} sections of input.
The Cotton ordering of the irredicible representations is used.
The default is the zero vector.</p>
<p>FROZEN_UOCC = (integer array)]mbox{}\
Should be in {tt psi:()} or {tt default:()} sections of input.
The number of highest energy unoccupied orbitals in each irreducible
representation into which there will be no excitations.
These orbitals are literally frozen and are not optimized in the MCSCF;
usually one wishes to use {tt RESTRICTED_UOCC} instead.
The current version of the program does not allow both
{tt RESTRICTED_UOCC} and {tt FROZEN_UOCC}.
Should be in {tt psi:()} or {tt default:()} sections of input.
The default is the zero vector.</p>
<p>NCASITER = integer]mbox{}\
Maximum number of iterations to optimize the orbitals.  This option
should be specified in the DEFAULT section of input, because
it needs to be visible to the control program PSI.  Defaults to 20.</p>
<p>AVERAGE_STATES = (integer array)]mbox{}\
This gives a list of what states to average for the orbital
optimization.  States are numbered starting from 1.</p>
<p>PRINT = integer]mbox{}\
This option determines the verbosity of the output.  A value of 1 or
2 specifies minimal printing, a value of 3 specifies verbose printing.
Values of 4 or 5 are used for debugging.  Do not use level 5 unless
the test case is very small (e.g. STO H<sub>2</sub>O CISD).</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h2>
<p>Example of a CASSCF single-point calculation for H<sub>2</sub>O using
a valence active space 3a<sub>1</sub> 1b<sub>1</sub> 2b<sub>2</sub>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="mi">6</span><span class="o">-</span><span class="mi">31</span><span class="n">G</span><span class="o">**</span> <span class="n">H2O</span> <span class="n">Test</span> <span class="n">CASSCF</span> <span class="n">Energy</span> <span class="n">Point</span>

<span class="n">psi</span><span class="p">:</span> <span class="p">(</span>
  <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;6-31G** CASSCF H2O&quot;</span>
  <span class="n">jobtype</span> <span class="o">=</span> <span class="n">sp</span>
  <span class="n">wfn</span> <span class="o">=</span> <span class="n">casscf</span>
  <span class="n">reference</span> <span class="o">=</span> <span class="n">rhf</span>
  <span class="n">restricted_docc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">)</span>
  <span class="n">active</span>          <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">basis</span> <span class="o">=</span> <span class="s2">&quot;6-31G**&quot;</span>
  <span class="n">zmat</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">o</span>
    <span class="n">h</span> <span class="mi">1</span> <span class="mf">1.00</span>
    <span class="n">h</span> <span class="mi">1</span> <span class="mf">1.00</span> <span class="mi">2</span> <span class="mf">103.1</span>
  <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">Psi4 Documentation</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Harishankar.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../../_sources/doc/sphinxman/source/attic/detcas.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>