<!DOCTYPE html>

<html lang="English" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>General layout of the core: where new C++ code should live &#8212; Psi4 Documentation 1.11 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../_static/documentation_options.js?v=29ef4520"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="general-layout-of-the-core-where-new-c-code-should-live">
<span id="sec-prog-tour"></span><h1>General layout of the core: where new C++ code should live<a class="headerlink" href="#general-layout-of-the-core-where-new-c-code-should-live" title="Link to this heading">¶</a></h1>
<section id="new-integral-operators">
<h2>New integral operators<a class="headerlink" href="#new-integral-operators" title="Link to this heading">¶</a></h2>
<p>Most of the heavy lifting in <a href="#id17"><span class="problematic" id="id18">|PSIfour|</span></a> is handled by libmints, which can be
found in the <a href="#id1"><span class="problematic" id="id2">:source:`psi4/src/psi4/libmints`</span></a> directory.  New types of one- and
two-electron integral operators should be added here.  The Wavefunction class
<a href="#id3"><span class="problematic" id="id4">:source:`psi4/src/psi4/libmints/wavefunction.h`</span></a> is also found here and is a key
part of the infrastructure.  Every energy calculation is performed by a class
that derives from Wavefunction and is accessible as a return value in the
Python layer.  The Wavefunction class contains all pertinent calculation
results, such as one-particle densities, molecular orbitals and gradients.</p>
</section>
<section id="completely-new-methods">
<h2>Completely new methods<a class="headerlink" href="#completely-new-methods" title="Link to this heading">¶</a></h2>
<p>A new method that is not a modification of existing code belongs in its own
folder in <a href="#id5"><span class="problematic" id="id6">:source:`psi4/src/psi4`</span></a>; see other folders in that exist in that
location for examples of setting up CMake, and make sure that the new folder is
added to <a href="#id7"><span class="problematic" id="id8">:source:`psi4/src/psi4/CMakeLists.txt`</span></a>.  There are also a number of
variables that can be exported to be available to the user, as detailed in
<a class="reference internal" href="psithoninput.html#sec-psivariables"><span class="std std-ref">PSI Variables</span></a>.  To set these variables, the following member of
Wavefunction should be called:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">set_variable</span><span class="p">(</span><span class="s2">&quot;Variable Name&quot;</span><span class="p">,</span> <span class="n">variable_value</span><span class="p">);</span>
</pre></div>
</div>
<p>The new variable should also be documented in
<a href="#id9"><span class="problematic" id="id10">:source:`doc/sphinxman/source/glossary_psivariables.rst`</span></a>.  There are a
number of different helpers to export various quantities from the wavefunction
to external formats such as FCHK and MOLDEN.  Because the Wavefunction makes
its members available to the Python layer, any other similar export functions
should be written in python.</p>
</section>
<section id="integral-consuming-technologies">
<h2>Integral consuming technologies<a class="headerlink" href="#integral-consuming-technologies" title="Link to this heading">¶</a></h2>
<p>The general philosophy in <a href="#id19"><span class="problematic" id="id20">|PSIfour|</span></a> is to try write two-electron integral
driven tasks in methods like Hartree-Fock, CIS and CPHF in terms of generalized
Fock-like matrices.  From here, a single class can be used to construct these
generalized Fock matrices, which is what libFock
(<a href="#id11"><span class="problematic" id="id12">:source:`psi4/src/psi4/libfock`</span></a>) accomplishes.  A number of integral
technologies -- such as integral-direct, disk-based and density fitting -- are
supported in libFock, making them generally available to all elements of the
code that use the generalized Fock matrix strategy.</p>
</section>
<section id="exposing-c-code-to-python">
<span id="sec-prog-tour-exposing"></span><h2>Exposing C++ code to Python<a class="headerlink" href="#exposing-c-code-to-python" title="Link to this heading">¶</a></h2>
<p>The recent push to move sections of the code that are not a bottleneck into the
Python layer requires that the C++ code is callable from Python and that its
results are accessible.  The result accessibility is addressed by populating
the appropriate variables in the Wavefunction object.  To make the code
callable from Python, we rely on the excellent <a class="reference external" href="https://pybind11.readthedocs.io/en/stable/">PyBind11</a> library
to create the bindings.  Existing code to export various <a href="#id21"><span class="problematic" id="id22">|PSIfour|</span></a> classes can
be found in <a href="#id13"><span class="problematic" id="id14">:source:`psi4/src`</span></a> in the files whose name begins with <cite>export_</cite>.
The code to export functions that run entire calculations is usually found in
<a href="#id15"><span class="problematic" id="id16">:source:`psi4/src/core.cc`</span></a>.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Psi4 Documentation</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Harishankar.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../_sources/doc/sphinxman/source/prog_tour.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>