<!DOCTYPE html>

<html lang="English" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Defining a Method Alias &#8212; Psi4 Documentation 1.11 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../_static/documentation_options.js?v=29ef4520"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="defining-a-method-alias">
<span id="sec-methodalias"></span><span id="index-0"></span><h1>Defining a Method Alias<a class="headerlink" href="#defining-a-method-alias" title="Link to this heading">Â¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No recompile of the <a href="#id7"><span class="problematic" id="id8">|PSIfour|</span></a> program is necessary for changes made to
files in <code class="docutils literal notranslate"><span class="pre">$PSIDATADIR</span></code> aka <a href="#id1"><span class="problematic" id="id2">:source:`psi4/share/psi4`</span></a>, including those described below.</p>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>As of 1.0, the below, while essentially still correct, is so aged
as to be difficult to follow.</p>
</div>
<p>Since quantum chemical methods in <a href="#id9"><span class="problematic" id="id10">|PSIfour|</span></a> are accessed through Python functions, and
most important quantities are available as PSI variables, it is straightforward
to create aliases to commonly run calculations or to define hybrid methods. The
<a href="#id3"><span class="problematic" id="id4">:source:`psi4/driver/aliases.py`</span></a> file is intended for editing by the user for
this purpose.</p>
<p>As an example, the MP2.5 method
(which admittedly is already built in to <a href="#id11"><span class="problematic" id="id12">|PSIfour|</span></a>)
is the average of MP2 and MP3. The latter is
available through the arbitrary order MPn code and returns all lower energies
along with it in PSI variables. The following is basic code that will compute
and return the MP2.5 energy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_mp2_5</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="n">energy</span><span class="p">(</span><span class="s1">&#39;mp3&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">e_scf</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="s1">&#39;SCF TOTAL ENERGY&#39;</span><span class="p">)</span>
    <span class="n">ce_mp2</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="s1">&#39;MP2 CORRELATION ENERGY&#39;</span><span class="p">)</span>
    <span class="n">ce_mp3</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="s1">&#39;MP3 CORRELATION ENERGY&#39;</span><span class="p">)</span>

    <span class="n">ce_mp25</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">ce_mp2</span> <span class="o">+</span> <span class="n">ce_mp3</span><span class="p">)</span>
    <span class="n">e_mp25</span> <span class="o">=</span> <span class="n">e_scf</span> <span class="o">+</span> <span class="n">ce_mp25</span>

    <span class="nb">print</span> <span class="s2">&quot;&quot;&quot;  MP2.5 total energy:                      </span><span class="si">%16.8f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e_mp25</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s2">&quot;&quot;&quot;  MP2.5 correlation energy:                </span><span class="si">%16.8f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ce_mp25</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">e_mp25</span>
</pre></div>
</div>
<p>Compare the above to the method that resides in <a href="#id5"><span class="problematic" id="id6">:source:`psi4/driver/aliases.py`</span></a>.
The rationale for the changes is indicated in the comments below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_mp2_5</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">lowername</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="c1"># handy variable with name keyword in lowercase</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs_lower</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># removes case sensitivity in keyword names</span>

    <span class="c1"># Run detci calculation and collect conventional quantities</span>
    <span class="n">energy</span><span class="p">(</span><span class="s1">&#39;mp3&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">e_scf</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="s1">&#39;SCF TOTAL ENERGY&#39;</span><span class="p">)</span>
    <span class="n">ce_mp2</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="s1">&#39;MP2 CORRELATION ENERGY&#39;</span><span class="p">)</span>
    <span class="n">ce_mp3</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="s1">&#39;MP3 CORRELATION ENERGY&#39;</span><span class="p">)</span>
    <span class="n">e_mp2</span> <span class="o">=</span> <span class="n">e_scf</span> <span class="o">+</span> <span class="n">ce_mp2</span>  <span class="c1"># reform mp2 and mp3 total energies for printing</span>
    <span class="n">e_mp3</span> <span class="o">=</span> <span class="n">e_scf</span> <span class="o">+</span> <span class="n">ce_mp3</span>

    <span class="c1"># Compute quantities particular to MP2.5</span>
    <span class="n">ce_mp25</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">ce_mp2</span> <span class="o">+</span> <span class="n">ce_mp3</span><span class="p">)</span>
    <span class="n">e_mp25</span> <span class="o">=</span> <span class="n">e_scf</span> <span class="o">+</span> <span class="n">ce_mp25</span>
    <span class="n">psi4</span><span class="o">.</span><span class="n">set_variable</span><span class="p">(</span><span class="s1">&#39;MP2.5 CORRELATION ENERGY&#39;</span><span class="p">,</span> <span class="n">ce_mp25</span><span class="p">)</span>  <span class="c1"># add new method&#39;s important results</span>
    <span class="n">psi4</span><span class="o">.</span><span class="n">set_variable</span><span class="p">(</span><span class="s1">&#39;MP2.5 TOTAL ENERGY&#39;</span><span class="p">,</span> <span class="n">e_mp25</span><span class="p">)</span>         <span class="c1">#     to PSI variable repository</span>
    <span class="n">psi4</span><span class="o">.</span><span class="n">set_variable</span><span class="p">(</span><span class="s1">&#39;CURRENT CORRELATION ENERGY&#39;</span><span class="p">,</span> <span class="n">ce_mp25</span><span class="p">)</span>
    <span class="n">psi4</span><span class="o">.</span><span class="n">set_variable</span><span class="p">(</span><span class="s1">&#39;CURRENT ENERGY&#39;</span><span class="p">,</span> <span class="n">e_mp25</span><span class="p">)</span>  <span class="c1"># geometry optimizer tracks this variable, permits</span>
                                                   <span class="c1">#     MP2.5 finite difference optimizations</span>
    <span class="c1"># build string of title banner and print results</span>
    <span class="n">banners</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">banners</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;psi4.print_out(&#39;</span><span class="se">\\</span><span class="s2">n&#39;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="n">banners</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;banner(&#39; MP2.5 &#39;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="n">banners</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;psi4.print_out(&#39;</span><span class="se">\\</span><span class="s2">n&#39;)</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="n">exec</span> <span class="n">banners</span>

    <span class="n">tables</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  SCF total energy:                        </span><span class="si">%16.8f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e_scf</span><span class="p">)</span>
    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  MP2 total energy:                        </span><span class="si">%16.8f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e_mp2</span><span class="p">)</span>
    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  MP2.5 total energy:                      </span><span class="si">%16.8f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e_mp25</span><span class="p">)</span>
    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  MP3 total energy:                        </span><span class="si">%16.8f</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e_mp3</span><span class="p">)</span>
    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  MP2 correlation energy:                  </span><span class="si">%16.8f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ce_mp2</span><span class="p">)</span>
    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  MP2.5 correlation energy:                </span><span class="si">%16.8f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ce_mp25</span><span class="p">)</span>
    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;  MP3 correlation energy:                  </span><span class="si">%16.8f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ce_mp3</span><span class="p">)</span>
    <span class="n">psi4</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span>  <span class="c1"># prints nice header and table of all involved quantities to output file</span>

    <span class="k">return</span> <span class="n">e_mp25</span>
</pre></div>
</div>
<p>One final step is necessary. At the end of the <code class="docutils literal notranslate"><span class="pre">aliases.py</span></code> file, add
the following line.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">procedures</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="s1">&#39;mp2.5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run_mp2_5</span>
</pre></div>
</div>
<p>This permits the newly defined MP2.5 method to be called in the input file
with the following command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">energy</span><span class="p">(</span><span class="s1">&#39;mp2.5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Psi4 Documentation</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Harishankar.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../_sources/doc/sphinxman/source/quickaddalias.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>